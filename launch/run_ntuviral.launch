<launch>

    <!--- SAM -->
    
    <!-- Lidar odometry param -->
    <rosparam file="$(find lvi_sam)/config/ntuviral/params_lidar.yaml" command="load" />

    <!-- VINS config -->
    <param name="vins_config_file" type="string" value="$(find lvi_sam)/config/params_camera.yaml" />
    
    <!-- Lidar odometry -->
    <node pkg="lvi_sam"  type="lvi_sam_imuPreintegration" name="lvi_sam_imuPreintegration" output="screen" respawn="true"/>
    <node pkg="lvi_sam"  type="lvi_sam_imageProjection"   name="lvi_sam_imageProjection"   output="screen" respawn="true"/>
    <node pkg="lvi_sam"  type="lvi_sam_featureExtraction" name="lvi_sam_featureExtraction" output="screen" respawn="true"/>
    <node pkg="lvi_sam"  type="lvi_sam_mapOptmization"    name="lvi_sam_mapOptmization"    output="screen" respawn="true"/>

    <!-- Visual feature and odometry -->
    <node pkg="lvi_sam"  type="lvi_sam_visual_feature"    name="lvi_sam_visual_feature"    output="screen" respawn="true"/>
    <node pkg="lvi_sam"  type="lvi_sam_visual_odometry"   name="lvi_sam_visual_odometry"   output="screen" respawn="true"/>
    <node pkg="lvi_sam"  type="lvi_sam_visual_loop"       name="lvi_sam_visual_loop"       output="screen" respawn="true"/>

    <!-- Image conversion -->
    <node pkg="image_transport" type="republish" name="lvi_sam_republish" args="compressed in:=/camera/image_raw raw out:=/camera/image_raw" output="screen" respawn="true"/>


    <!--- Run Rviz-->
    <node pkg="rviz" type="rviz" name="lvi_sam_rviz" args="-d $(find lvi_sam)/launch/rviz_ntuviral.rviz" />


    <!-- Playing the rosbag -->
    <node required="true" pkg="rosbag" type="play" name="rosbag_play"
          args="--clock /media/$(env USER)/mySataSSD/DATASETS/LVI_DATASETS/garden.bag"/>

</launch>
